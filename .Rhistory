sum2 <- group_by(i2, Beat) %>% summarise(num=sum(X..offenses))
sum3 <- group_by(i3, Beat) %>% summarise(num=sum(X..offenses))
install.packages("magrittr")
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
library(magrittr)
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
library(lubridate)
library(xts)
library(dplyr)
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
library(dplyr)
install.packages("dplyr")
library(dplyr)
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
help(paste)
dat$Date,' ',dat$Hour
paste(dat$Date,' ',dat$Hour)
ymd_h(paste(dat$Date,' ',dat$Hour))
help(xts)
help(filter)
datxts <- xts(dat, ymd_h(paste(dat$Date,' ',dat$Hour)))
i1 <- filter(datxts, 8 <= dat$Hour & dat$Hour < 12)
help(xts)
i1
i2
nrow(i1[is.na(i1),])
nrow(i1[is.na(i1)])
nrow(i1[is.na(i1)])
i1[is.na(i1)]
ncol(i1[is.na(i1)])
View(datxts)
View(datxts)
unique(dat$Hour)
unique(dat$Date)
library(lubridate)
library(xts)
library(dplyr)
datxts <- xts(dat, ymd_h(paste(dat$Date,' ',dat$Hour)))
i1 <- filter(dat, 8 <= dat$Hour, dat$Hour < 12)
i2 <- filter(dat, 12 <= dat$Hour, dat$Hour < 19)
i3 <- filter(dat, (19 <= dat$Hour & dat$Hour <= 23) | (0 <= dat$Hour & dat$Hour < 8))
View(i1)
View(i1)
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
sum2 <- group_by(i2, Beat) %>% summarise(num=sum(X..offenses))
sum3 <- group_by(i3, Beat) %>% summarise(num=sum(X..offenses))
View(sum1)
View(sum1)
View(sum1)
View(sum1)
View(sum2)
View(sum2)
group_by(i1, Beat)
help(table)
group_by(dat$Offense.Type, dat$X..offenses)
group_by(Offense.Type, X..offenses)
group_by(dat, Offense.Type)
group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
sum4 <- group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
barplot(sum4)
help(barplot)
as.matrix(sum4)
barplot(as.matrix(sum4))
dat <- subset(dat, dat$Offense.Type != 1)
datxts <- xts(dat, ymd_h(paste(dat$Date,' ',dat$Hour)))
i1 <- filter(dat, 8 <= dat$Hour, dat$Hour < 12)
i2 <- filter(dat, 12 <= dat$Hour, dat$Hour < 19)
i3 <- filter(dat, (19 <= dat$Hour & dat$Hour <= 23) | (0 <= dat$Hour & dat$Hour < 8))
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
sum2 <- group_by(i2, Beat) %>% summarise(num=sum(X..offenses))
sum3 <- group_by(i3, Beat) %>% summarise(num=sum(X..offenses))
sum4 <- group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
barplot(as.matrix(sum4))
as.matrix(sum4)
barplot(as.matrix(sum4)[2])
as.matrix(sum4)[2]
as.matrix(sum4)[2,]
as.matrix(sum4)[, 2]
barplot(as.matrix(sum4)[, 2])
barplot(as.matrix(sum4)[, 2], as.matrix(sum4)[, 1])
as.matrix(sum4)[, 1]
plot(as.matrix(sum4)[, 2], as.matrix(sum4)[, 1])
plot(as.matrix(sum4)[, 2] ~ as.matrix(sum4)[, 1])
as.matrix(sum4)[, 1]
as.matrix(sum4)[, 2]
plot(strtoi(as.matrix(sum4)[, 2]) ~ as.matrix(sum4)[, 1])
strtoi(as.matrix(sum4)[, 2])
as.matrix(sum4)[, 1]
plot(strtoi(as.matrix(sum4)[, 2]), as.matrix(sum4)[, 1])
as.matrix(sum4)
plot(strtoi(as.matrix(sum4)$num), as.matrix(sum4)$Offense.Type)
sum4 <- group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
sum4
plot(sum4$num ~ sum4$Offense.Type)
barplot(sum4$num ~ sum4$Offense.Type)
plot(sum4$num ~ sum4$Offense.Type)
library(gdata)
perldir <- Sys.which("perl")
if (perldir == "" & .Platform$OS.type == "windows")
perldir <- "C:\\Perl64\\bin\\perl.exe"
fc <- "crime.xls"
dat <- read.xls(fc, sheet = 1, header = TRUE, verbose=FALSE, perl=perldir)
unique(dat$Offense.Type)
dat <- subset(dat, dat$Offense.Type != 1)
unique(dat$Beat)
unique(dat$Hour)
library(lubridate)
library(xts)
library(dplyr)
dat <- tbl_df(dat)
datxts <- xts(dat, ymd_h(paste(dat$Date,' ',dat$Hour)))
i1 <- filter(dat, 8 <= dat$Hour, dat$Hour < 12)
i2 <- filter(dat, 12 <= dat$Hour, dat$Hour < 19)
i3 <- filter(dat, (19 <= dat$Hour & dat$Hour <= 23) | (0 <= dat$Hour & dat$Hour < 8))
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
sum2 <- group_by(i2, Beat) %>% summarise(num=sum(X..offenses))
sum3 <- group_by(i3, Beat) %>% summarise(num=sum(X..offenses))
sum4 <- group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
plot(sum4$num ~ sum4$Offense.Type)
sum4
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", pch=4, main = "Number of offenses (per offense)")
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", pch=20, main = "Number of offenses (per offense)")
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", main = "Number of offenses (per offense)")
plot(sum4$num, sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", main = "Number of offenses (per offense)")
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", main = "Number of offenses (per offense)")
sum5 <- group_by(dat, Offense.Type, Beat)
sum 5
sum()
sum5
sum5 <- group_by(dat, Offense.Type, Beat) %>% summarise(num=sum(X..offenses))
sum5
euro2dollar <- function(p, tx = 1.34) p * tx
euro2dollar(100)
euro2dollar(100, 1.33)
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL, suff = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename) & is.null(suff))
return("error");
}
num_offenses()
View(i1)
View(i1)
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
return("error");
else if (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
return("error");
else (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
return("error");
else (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
result <- "error"
else (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
filter(dat, date == dat$Date)
date <- "2015-01-24"
filter(dat, date == dat$Date)
filter(dat, date == dat$Date)$X..offenses
sum(filter(dat, date == dat$Date)$X..offenses)
dat[!grep("^[0-9]{4}-[0-9]{2}-[0-9]{2}$", dat$Date),]
dat[!grep("^[0-9]{4}-[0-9]{2}-[0-9]{2}$", dat$Date),] == NULL
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
result <- "error"
else (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
result <- "error"
else  {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
return (result)
}
num_offenses <- function (date = NULL, hour = NULL, beat = NULL, blocrag = NULL, strename = NULL) {
if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename))
result <- "error"
#date
else if (is.null(hour) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
#hour
else if (is.null(date) & is.null(beat) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, hour == dat$Hour)$X..offenses)
}
#beat
else if (is.null(date) & is.null(hour) & is.null(blocrag) & is.null(strename)) {
result <- sum(filter(dat, beat == dat$Beat)$X..offenses, na.rm=TRUE)
}
#blockrange
else if (is.null(date) & is.null(hour) & is.null(beat) & is.null(strename)) {
result <- sum(filter(dat, blocrag == dat$BlockRange)$X..offenses, na.rm=TRUE)
}
#streetname
else if (is.null(date) & is.null(hour) & is.null(beat) & is.null(blocrag)) {
result <- sum(filter(dat, strename == dat$StreetName)$X..offenses)
}
return (result)
}
num_offenses(2100-2199)
num_offenses <- function (date = "all", hour = "all", beat = "all", blocrag = "all", strename = "all") {
if (date == "all" & hour == "all" & beat == "all" & blocrag == "all" & strename == "all")
result <- "error"
#date
else if (hour == "all" & beat == "all" & blocrag == "all" & strename == "all") {
result <- sum(filter(dat, date == dat$Date)$X..offenses)
}
#hour
else if (date == "all" & beat == "all" & blocrag == "all" & strename == "all") {
result <- sum(filter(dat, hour == dat$Hour)$X..offenses)
}
#beat
else if (date == "all" & hour == "all" & blocrag == "all" & strename == "all") {
result <- sum(filter(dat, beat == dat$Beat)$X..offenses, na.rm=TRUE)
}
#blockrange
else if (date == "all" & hour == "all" & beat == "all" & strename == "all") {
result <- sum(filter(dat, blocrag == dat$BlockRange)$X..offenses, na.rm=TRUE)
}
#streetname
else if (date == "all" & hour == "all" & beat == "all" & blocrag == "all") {
result <- sum(filter(dat, strename == dat$StreetName)$X..offenses)
}
return (result)
}
num_offenses(all, all, all, 2100-2199, all)
num_offenses("all", "all", "all", 2100-2199, "all")
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute = "Beat" | attribute = "BlockRange" | attribute == "StreetName") {
if (attribute = "Beat" | attribute = "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute = "Beat" | attribute = "BlockRange" | attribute == "StreetName") {
if (attribute = "Beat" | attribute = "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value = NULL, attribute = NULL) {
if (attribute == "Date" | attribute == "Hour" | attribute = "Beat" | attribute = "BlockRange" | attribute == "StreetName") {
if (attribute = "Beat" | attribute = "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute = "Beat" | attribute = "BlockRange" | attribute == "StreetName") {
if (attribute = "Beat" | attribute = "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute == "Beat" | attribute = "BlockRange" | attribute == "StreetName") {
if (attribute = "Beat" | attribute = "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute == "Beat" | attribute == "BlockRange" | attribute == "StreetName") {
if (attribute == "Beat" | attribute == "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses(2100-2199, BlockRabge)
num_offenses("2100-2199", "BlockRabge")
num_offenses("2015-01-24", "Date")
sum(filter(dat, 2015-01-24 == dat$Date)$X..offenses)
sum(filter(dat, "2015-01-24" == dat$Date)$X..offenses)
num_offenses("2015-01-24", "Date")
num_offenses("2015-01-24", Date)
num_offenses <- function (value, attribute) {
if (attribute == Date | attribute == "Hour" | attribute == "Beat" | attribute == "BlockRange" | attribute == "StreetName") {
if (attribute == "Beat" | attribute == "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses <- function (value, attribute) {
if (attribute == Date | attribute == "Hour" | attribute == "Beat" | attribute == "BlockRange" | attribute == "StreetName") {
if (attribute == "Beat" | attribute == "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses("2015-01-24", Date)
colnames(dat)
colnames(dat)[1]
num_offenses <- function (value, attribute) {
if (attribute == colnames(dat)[1] | attribute == colnames(dat)[2] | attribute == colnames(dat)[4] | attribute == colnames(dat)[6] | attribute == colnames(dat)[7]) {
if (attribute == "Beat" | attribute == "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
num_offenses("2015-01-24", Date)
num_offenses <- function (value, attribute) {
if (attribute == "Date" | attribute == "Hour" | attribute == "Beat" | attribute == "BlockRange" | attribute == "StreetName") {
if (attribute == "Beat" | attribute == "BlockRange")
result <- sum(filter(dat, value == dat$attribute)$X..offenses, na.rm = TRUE)
else
result <- sum(filter(dat, value == dat$attribute)$X..offenses)
}
else
result <- "error"
return(result)
}
help("filter")
filter(dat, date == dat$Date, beat == dat$Beat)
filter(dat, date == dat$Date)
num_offenses <- function (beat, date) filter(dat, beat == dat$Beat) %>% filter(dat, date == dat$Date)$X..offenses %>% sum()
num_offenses(10H10, 2015-01-24)
num_offenses("10H10", "2015-01-24")
num_offenses <- function (beat, date) filter(dat, beat == dat$Beat) %>% filter(date == dat$Date)$X..offenses %>% sum()
num_offenses("10H10", "2015-01-24")
num_offenses <- function (beat, date) sum(filter(filter(dat, beat == dat$Beat), date == dat$Date)$X..offenses)
num_offenses("10H10", "2015-01-24")
filter(dat, beat == dat$Beat)
filter(dat, "10H10" == dat$Beat)
filter(filter(dat, "10H10" == dat$Beat), "2015-01-24" == dat$Date)
filter(tbl_df(filter(dat, "10H10" == dat$Beat)), "2015-01-24" == dat$Date)
tbl_df(filter(dat, "10H10" == dat$Beat)
)
goup_by(Beat, Date)
group_by(Beat, Date)
group_by(dat, Beat)
group_by(dat, Beat) %>% group_by(Date)
num_offenses <- function (beat, date) sum(filter(dat, beat == dat$Beat & date == dat$Date)$X..offenses)
num_offenses("10H10", "2015-01-24")
filter(dat, beat == dat$Beat & date == dat$Date
)
filter(dat, beat == dat$Beat & date == dat$Date)
filter(dat, "10H10" == dat$Beat & "2015-01-24" == dat$Date)
dat %>% summarise(avg.Off=mean(dat$X..offenses),
cen.OffTp=centralValue(dat$Offense.Type),
cen.StrNm=centralValue(dat$StreetName))
library(dplyr)
dat %>% summarise(avg.Off=mean(dat$X..offenses),
cen.OffTp=centralValue(dat$Offense.Type),
cen.StrNm=centralValue(dat$StreetName))
install.packages("DMwR")
library(DMwR)
dat %>% summarise(avg.Off=mean(dat$X..offenses),
cen.OffTp=centralValue(dat$Offense.Type),
setwd(dir)
getwd()
#Install the necessary packages
install.packages("gdata")
install.packages("lubridate")
install.packages("xts")
install.packages("dplyr")
install.packages("DMwR")
#Load the packages
library(gdata)
library(lubridate)
library(xts)
library(dplyr)
library(stringr)
library(DMwR)
library(class)
perldir <- Sys.which("perl")
fc <- "crime.xls"
dat <- read.xls(fc, sheet = 1, header = TRUE, verbose=FALSE, perl=perldir, na.strings = "UNK")
dat$BlockRange <- as.character(dat$BlockRange)
dat$StreetName <- as.character(dat$StreetName)
dat$Type <- as.character(dat$Type)
dat$Suffix <- as.character(dat$Suffix)
unique(dat$Offense.Type)
dat[dat$Offense.Type == 1,]
#dat_clean <- dat[-(dat$Offense.Type == 1), ]
#dat <- subset(dat, dat$Offense.Type != 1)
dat[!grep("^[0-9]{4}-[0-9]{2}-[0-9]{2}$", dat$Date),]
dat[dat$Hour < 0 | dat$Hour > 23,]
dat[!grep("^[0-9]{2}$", dat$Hour),]
unique(dat$Beat)
nrow(dat[is.na(dat$Beat),])
load("gps.RData")
incomplete <- is.na(dat$Beat)
tr <- gps[!incomplete,1:2]
ts <- gps[incomplete,1:2]
dat$Beat[incomplete] <- knn(tr, ts, dat$Beat[!incomplete], k = 3)
View(gps)
View(gps)
View(tr)
View(tr)
View(ts)
View(ts)
incomplete
View(gps)
View(gps)
nrow(dat[is.na(dat$BlockRange),])
incomplete <- is.na(dat$BlockRange)
dat$BlockRange[incomplete] <- centralValue(dat$BlockRange)
unique(dat$Type)
nrow(dat[dat$Type == "-",])
unique(dat$Suffix)
nrow(dat[dat$Suffix == "-",])
unique(dat$X..offenses)
unique(dat$Suffix)
nrow(dat[dat$Suffix == "-",])
unique(dat$X..offenses)
dat <- tbl_df(dat)
#View the data per hour
datxts <- xts(dat, ymd_h(paste(dat$Date,' ',dat$Hour)))
#Split the data into 3 categories
i1 <- filter(dat, 8 <= dat$Hour, dat$Hour < 12)
i2 <- filter(dat, 12 <= dat$Hour, dat$Hour < 19)
i3 <- filter(dat, (19 <= dat$Hour & dat$Hour <= 23) | (0 <= dat$Hour & dat$Hour < 8))
#How many Offenses are made per interval in each category
sum1 <- group_by(i1, Beat) %>% summarise(num=sum(X..offenses))
sum2 <- group_by(i2, Beat) %>% summarise(num=sum(X..offenses))
sum3 <- group_by(i3, Beat) %>% summarise(num=sum(X..offenses))
#How many offenses are made per offense type
sum4 <- group_by(dat, Offense.Type) %>% summarise(num=sum(X..offenses))
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", main = "Number of offenses per offense type")
#How many offenses are made per offense type in each beat
sum5 <- group_by(dat, Offense.Type, Beat) %>% summarise(num=sum(X..offenses))
dat %>% summarise(avg.Off=mean(dat$X..offenses),
cen.OffTp=centralValue(dat$Offense.Type),
cen.StrNm=centralValue(dat$StreetName))
barplot(c(sum(sum1$num), sum(sum2$num), sum(sum3$num)), names.arg = c("8-12", "12-19", "19-8"), main = "Total crimes over time intervals")
beat <- group_by(dat, Beat) %>% summarise(num=sum(X..offenses))
most <- head(arrange(beat,desc(num)))
barplot(most$num, names.arg=most$Beat, main="Beats with most crimes")
least <- head(arrange(beat, num))
barplot(least$num, names.arg=least$Beat, main="Beats with least crimes")
boxplot(beat$num, main="Distribution of number of crimes per beat")
offenses <- group_by(dat, Offense.Type) %>%
filter(Offense.Type != 1) %>% summarize(total=sum(X..offenses))
barplot(offenses$total, names.arg=offenses$Offense.Type,
main="Number of occurences per crime type")
plot(sum4$num ~ sum4$Offense.Type, xlab = "Offense.Type", ylab = "Num", main = "Number of offenses (per offense)")
#Install the necessary packages
install.packages("gdata")
install.packages("lubridate")
install.packages("xts")
install.packages("dplyr")
install.packages("DMwR")
install.packages("lubridate")
install.packages("gdata")
install.packages("dplyr")
install.packages("xts")
install.packages("DMwR")
install.packages("gdata")
install.packages("gdata")
install.packages("gdata")
setwd(dir)
setwd(dir)
setwd(dir)
